from django.shortcuts import render

# Create your views here.

from django.http import HttpResponse
from django.shortcuts import get_object_or_404
from django.shortcuts import redirect

from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework import status
from .models import Malwarelist
from .serializers import MalwareSerializer


class MalwareView(APIView):

    def get(self, request, new_site=""):
        url_list = Malwarelist.objects.all()
        serializer = MalwareSerializer(url_list, many=True)

        path_info = request.META.get('PATH_INFO')
        http_host = request.META.get('HTTP_HOST')

        if new_site == "":
            return Response("Please add a website after /urlinfo/1/ in the current URL "
                            "to discover if the added site is a malware site.")

        is_malware = Malwarelist.objects.filter(url=new_site).exists()


        return Response(is_malware)

        # return Response(serializer.data)
